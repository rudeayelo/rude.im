---
title: Taming vertical white space with leading-trim and stitches
summary:
  leading-trim is a CSS-in-JS helper to trim spacing above and below text
  elements, here's how I use it along with stitches
publishedAt: "2021-03-03"
image: https://i.microlink.io/https%3A%2F%2Fcards.microlink.io%2F%3Fpreset%3Dajames%26p%3D2gPmPD4KICA8TGluawogICAgaHJlZj0naHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3MyP2ZhbWlseT1Tb3VyY2UrU2FucytQcm86d2dodEAzMDA7NjAwOzkwMCZkaXNwbGF5PWJsb2NrJwogICAgcmVsPSdzdHlsZXNoZWV0JwogIC8-CiAgPEZsZXgKICAgIHN4PXt7CiAgICAgIGFsaWduSXRlbXM6ICdmbGV4LXN0YXJ0JywKICAgICAganVzdGlmeUNvbnRlbnQ6ICdmbGV4LXN0YXJ0JywKICAgICAgZmxleERpcmVjdGlvbjogJ2NvbHVtbicsCiAgICAgIGJnOiAiaHNsKDIwNSw1JSw3JSkiLAogICAgICBwYWRkaW5nOiAiNDBweCIKICAgIH19CiAgPgogICAgPGltZyBzcmM9Imh0dHBzOi8vcnVkZS5pbS9mYXZpY29uLWRhcmsuc3ZnIiB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEyMCIgLz4KICAgIDxGbGV4IHN4PXt7CiAgICAgIG1hcmdpblRvcDogNCwKICAgICAgYWxpZ25JdGVtczogJ2ZsZXgtc3RhcnQnLAogICAgICBqdXN0aWZ5Q29udGVudDogJ2ZsZXgtc3RhcnQnLAogICAgICBmbGV4RGlyZWN0aW9uOiAnY29sdW1uJywKICAgIH19PgogICAgPFRleHQKICAgICAgc3g9e3sKICAgICAgICBmb250RmFtaWx5OiAnU291cmNlIFNhbnMgUHJvJywKICAgICAgICBmb250U2l6ZTogNSwKICAgICAgICBmb250V2VpZ2h0OiA2MDAsCiAgICAgICAgY29sb3I6ICJoc2woMjA1LDUlLDY1JSkiLAogICAgICB9fQogICAgPgogICAgICBSdWRlIEF5ZWxvCiAgICA8L1RleHQ-CiAgICA8VGV4dAogICAgICBzeD17ewogICAgICAgIGZvbnRGYW1pbHk6ICdTb3VyY2UgU2FucyBQcm8nLAogICAgICAgIGZvbnRTaXplOiAiNjZweCIsCiAgICAgICAgZm9udFdlaWdodDogNzAwLAogICAgICAgIGxpbmVIZWlnaHQ6IDEsCiAgICAgICAgY29sb3I6ICJoc2woMjA1LDUlLDkwJSkiCiAgICAgIH19CiAgICA-CiBUYW1pbmcgdmVydGljYWwgd2hpdGUgc3BhY2Ugd2l0aCBsZWFkaW5nLXRyaW0gYW5kIHN0aXRjaGVzCiAgICA8L1RleHQ-CiAgICA8L0ZsZXg-CiAgPC9GbGV4Pgo8Lz4%23
---

I've been designing and developing websites for a while now and one of the
trickiest issues I always come accross is **handling vertical white space
between text nodes**. When working on a layout in a visual design app, my
typical workflow is:

1. Place text right near the previous/next one
2. Nudge up/down on a 4px basis until it looks right
3. Repeat

That way I'm able to ship solid and crisp designs quite quickly.

Translating those designs to HTML/CSS is a whole different story, text bounding
boxes are defined by the `line-height` in use and it's not so easy to separate
text blocks using a **consistent spacing system**.

That's why a while ago I created [leading-trim], a little CSS-in-JS helper to
trim spacing above and below the first and last lines of a text block. You can
check what it does in this demo:

<LeadingTrimDemo />

Since I'm using [stitches] to write the styles for this site, I thought I could
make a little wrapper around **leading-trim** using its `utils` feature

```ts
import { createCss } from "@stitches/react";
import { leadingTrim } from "leading-trim";

const { styled } = createCss({
  theme: {
    fonts: {
      sans:
        "Source Sans, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif",
    },
    fontSizes: {
      1: "16px",
      2: "20px",
    },
    lineHeights: {
      1: "1.5",
      2: "1.4",
    },
  }
  utils: {
    textSize: ({ theme }) => (value: `$${keyof typeof theme.fontSizes}`) => {
      const size = value.substr(1);

      return {
        textSize: value,
        margin: 0,
        ...leadingTrim({
          lineHeight: Number(theme.lineHeights[size]),
          reference: {
            textSize: 40,
            lineHeight: 1,
            topCrop: 4,
            bottomCrop: 8,
          },
        }),
      };
    },
  },
});

const Text = styled("p", {
  textSize: "$1"
});
```

I'm keeping a direct relation between `fontSizes` and `lineHeights` so font size
`$1` goes well with line height `$1`, that eases a bit the definition of the
util. [In this site the definition is a bit more complex][style-src] to allow
setting `line-height` on the fly and also adjusting leading-trim's `correction`:

```ts
textSize: "$1 / $1 / 2 / -1";
```

The `value` taken by the util is typed to match the `fontSizes` provided in the
`theme`, but [in this site I'm losely typing it][style-src] to allow other
values like `clamp($6, 5vw, $7)` and have responsive font sizes (`leadingTrim`
returns sizes in `em` so it works perfectly fine). In that case parsing the size
requires looking up for a specific token:

```ts
const sizes = value.match(/\$(\d+)/g);
const largestSize = sizes[sizes.length - 1].substring(1);
```

`leadingTrim` returns an object of CSS styles so we can destructure it right
away

---

Since I started using this technique I feel way more confident about the outcome
of my code and I don't go into visual design tools that much anymore.

[Drop me a line on Twitter](https://twitter.com/Rude) if you'd be interested in
an _npm package_ wrapping this util to easily include **leading-trim** in your
stitches based sites.

If your'e interested go check [leading-trim on Github][leading-trim], which has
some more information and links about the topic.

[leading-trim]: https://github.com/rudeayelo/leading-trim
[stitches]: https://stitches.dev/
[style-src]: https://github.com/rudeayelo/rude.im/blob/main/src/styles.ts
